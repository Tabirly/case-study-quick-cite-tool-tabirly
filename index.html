<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Case Study: Tabirly Ekosisteminde &quot;Quick-Cite&quot; Mimarisinin Teknik Analizi</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <main class="container">
    <article class="card">
      <figure class="figure"><img class="doc-img" src="assets/doc-image-1.png" alt=""></figure>
      <div class="spacer"></div>
      <h1>Case Study: Tabirly Ekosisteminde "Quick-Cite" Mimarisinin Teknik Analizi</h1>
      <p>https://tr.tabirly.com/</p>
      <div class="spacer"></div>
      <p>Proje: Tabirly Quick-Cite (QC) â€” v2025-09-06</p>
      <p>Platform: Blogger AltyapÄ±sÄ± / Vanilla JS Entegrasyonu</p>
      <p>Kapsam: Ä°stemci TaraflÄ± DoÄŸal Dil Ä°ÅŸleme (NLP) ve DOM ManipÃ¼lasyonu</p>
      <p>Yazar: Tabirly Teknik Ekibi</p>
      <div class="spacer"></div>
      <div class="spacer"></div>
      <div class="spacer"></div>
      <h2>1. YÃ¶netici Ã–zeti: Problemin TanÄ±mÄ± ve Ã‡Ã¶zÃ¼m</h2>
      <p>Tabirly gibi spiritÃ¼el, felsefi ve derinlikli konularÄ± ele alan platformlarda, bilginin kaynaÄŸÄ±nÄ± doÄŸrulanabilir kÄ±lmak hayati Ã¶nem taÅŸÄ±r. Ancak Blogger gibi geleneksel CMS yapÄ±larÄ±nda, uzun bir makale iÃ§indeki yÃ¼zlerce atÄ±fÄ± (citation) yÃ¶netmek, dipnotlarÄ± &lt;sup&gt; etiketleriyle manuel olarak eÅŸleÅŸtirmek ve bunlarÄ± kaynakÃ§a listesiyle senkronize etmek yazar iÃ§in hataya aÃ§Ä±k ve zaman alÄ±cÄ± bir sÃ¼reÃ§tir.</p>
      <p><strong>Quick-Cite (QC)</strong>, bu sÃ¼reci otomatize etmek iÃ§in geliÅŸtirilmiÅŸ, sadece editÃ¶r modunda Ã§alÄ±ÅŸan (?qc=1), tarayÄ±cÄ± tabanlÄ± "akÄ±llÄ± bir asistandÄ±r". Bu kod, statik bir HTML sayfasÄ±nÄ±, Ã¼zerinde Ã§alÄ±ÅŸÄ±labilir dinamik bir veritabanÄ±na dÃ¶nÃ¼ÅŸtÃ¼rÃ¼r.</p>
      <h2>2. Genel Mimari ve KonumlandÄ±rma</h2>
      <p>Quick-Cite, Tabirlyâ€™nin sunucu tarafÄ±na (server-side) yÃ¼k bindirmeden, tamamen <strong>istemci tarafÄ±nda (browser context)</strong> Ã§alÄ±ÅŸacak ÅŸekilde tasarlanmÄ±ÅŸtÄ±r.</p>
      <ul>
      <li><strong>Entegrasyon:</strong> Kod, Bloggerâ€™Ä±n ÅŸablon yapÄ±sÄ±na "parazit olmayan" bir katman olarak eklenir. if(!(q.get('qc')==='1'||preview)) return; satÄ±rÄ± sayesinde, normal ziyaretÃ§iler bu kodun varlÄ±ÄŸÄ±ndan haberdar olmaz ve site performansÄ± etkilenmez. Sadece editÃ¶r ?qc=1 parametresiyle girdiÄŸinde "Admin Modu" aktifleÅŸir.</li>
      <li><strong>Platform Hack (ClickTrap Bypass):</strong> Blogger, taslak Ã¶nizleme modunda sayfanÄ±n Ã¼zerine ÅŸeffaf bir katman (.blogger-clickTrap) Ã¶rerek etkileÅŸimi kÄ±sÄ±tlar. Quick-Cite, pointer-events:none CSS enjeksiyonu ile bu katmanÄ± "delerek" editÃ¶rÃ¼n Ã§ift tÄ±klama eventlerini yakalayabilmesini saÄŸlar. Bu, platformun sÄ±nÄ±rlarÄ±nÄ±n aÅŸÄ±ldÄ±ÄŸÄ± kritik bir mÃ¼hendislik detayÄ±dÄ±r.</li>
      <li><strong>BaÄŸÄ±msÄ±zlÄ±k:</strong> Herhangi bir dÄ±ÅŸ kÃ¼tÃ¼phane (jQuery, React vb.) kullanmaz. Saf (Vanilla) JavaScript ile yazÄ±larak maksimum performans ve sÄ±fÄ±r baÄŸÄ±mlÄ±lÄ±k hedeflenmiÅŸtir.</li>
      </ul>
      <details>
      <summary><strong>ğŸ‘¨â€ğŸ’» Ä°ncele: Quick-Cite Ana Motor Kodu (Tam SÃ¼rÃ¼m)</strong></summary>
      <pre class="code-block"><code class="language-html">&lt;!-- TB: Quick-Cite (QC) â€” v2025-09-06 â€” toggle ?qc=1 --&gt;
&lt;script id="tb-qc"&gt;
//&lt;![CDATA[
(function(){
  var q=new URLSearchParams(location.search), host=location.hostname;
  var preview=/(^|\.)blogger\.com$/.test(host)||/(^|\.)draft\.blogger\.com$/.test(host)||/blogspot\./.test(host);
  if(!(q.get('qc')==='1'||preview)) return;

  // Preview clickTrap bypass (tek sefer)
  if(preview &amp;&amp; !document.getElementById('tb-clicktrap-bypass')){
    var st=document.createElement('style'); st.id='tb-clicktrap-bypass';
    st.textContent='.blogger-clickTrap,[class*="clickTrap"]{pointer-events:none!important;}';
    document.head.appendChild(st);
  }

  // ---- CSS
  if(!document.getElementById('tb-cite-css')){
    var css=document.createElement('style'); css.id='tb-cite-css';
    css.textContent = `
:root{ --tb-header-offset:72px; }
#refs li{ scroll-margin-top: var(--tb-header-offset); }
#refs li.tb-ref-highlight{ outline:2px solid rgba(255,193,7,.6); background:rgba(255,225,130,.35); transition:background .6s; }
#tb-qc{ position:absolute; z-index:10000; background:#111; color:#fff; font-size:.9rem; border-radius:8px; padding:.35rem .55rem; display:none; box-shadow:0 10px 30px rgba(0,0,0,.25); }
#tb-qc .row{display:flex;gap:.4rem;align-items:center;margin:.35rem 0}
#tb-qc label{display:flex;gap:.4rem;align-items:flex-start;cursor:pointer}
#tb-qc footer{display:flex;gap:.5rem;justify-content:flex-end;margin-top:.4rem}
.tb-cite-added{animation:tbFlash 1.3s ease}
@keyframes tbFlash{0%{background:rgba(255,225,130,.5)}100%{background:transparent}}`;
    document.head.appendChild(css);
  }

  var isPost = document.body.classList.contains('item-view') || document.querySelector('.post-body');
  if (!isPost) return;
  var body = document.querySelector('.post-body') || document;

  function norm(s){ return (s||'').toString().trim().replace(/\s+/g,' '); }
  function deaccent(s){ try{return (s||'').normalize('NFKD').replace(/[\u0300-\u036f]/g,'');}catch(_){return s;} }
  function tok(s){ s=deaccent(norm(s)).toLowerCase().replace(/[â€œâ€"â€™'()\-.,;:!?]/g,' '); return s.split(/\s+/).filter(Boolean); }
  function getText(el){ return norm(el.textContent||''); }

  var refs = body.querySelector('#refs') || (function(){ var ls=Array.from(body.querySelectorAll('ol,ul')); return ls.length?ls[ls.length-1]:null; })();
  if(!refs) return;

  // anchor Ã¼ret
  Array.from(refs.querySelectorAll('li')).forEach(function(li,i){
    var id='kaynak'+(i+1);
    if(!document.getElementById(id)){ var s=document.createElement('span'); s.id=id; li.insertBefore(s, li.firstChild); }
  });

  function yearOf(t){ var m=t.match(/(?:\D|^)((?:1[4-9]\d{2}|20\d{2}|19\d{2}))/i); return m?m[1]:''; }
  function titleOf(li){ var e=li.querySelector('em,i'); if(e) return getText(e); var t=getText(li), p=t.split('. '); return p.length&gt;1?p[1]:t; }
  function authorsOf(t){
    t=t.replace(/\bet al\.?/ig,' ');
    var head=t.split('.')[0], frags=head.split(/[,;&amp;]/).map(norm).filter(Boolean), parts=[];
    var particles=new Set(['al','bin','b.','van','von','de','da','di','del','della','der','le','la','mac','mc',"o'",'ibn','el','ve','and','&amp;']);
    frags.forEach(function(p){ var ws=p.split(/\s+/); if(!ws.length) return; var i=ws.length-1, pick=[ws[i]]; i--; while(i&gt;=0&amp;&amp;particles.has(ws[i].toLowerCase())){pick.unshift(ws[i]); i--;} parts.push(pick.join(' ')); });
    if(!parts.length){ var m=t.match(/^\s*([A-ZÃ‡ÄÄ°Ã–ÅÃœ][A-Za-zÃ‡ÄÄ°Ã–ÅÃœÃ§ÄŸÄ±Ã¶ÅŸÃ¼â€™'\-]+(?:\s+[A-ZÃ‡ÄÄ°Ã–ÅÃœa-zÃ§ÄŸÄ±Ã¶ÅŸÃ¼â€™'\-]+){0,3})/); if(m) parts=[m[1]]; }
    var seen={}, out=[]; parts.forEach(function(a){ a=norm(a); if(a&amp;&amp;!seen[a]){seen[a]=1; out.push(a);} }); return out.slice(0,3);
  }

  var items = Array.from(refs.querySelectorAll('li'));
  var refIndex = items.map(function(li, idx){
    var full=getText(li), title=titleOf(li), authors=authorsOf(full);
    return { n:idx+1, anchor:'kaynak'+(idx+1), title, authors, year:yearOf(full), titleToks:tok(title), authorToks:tok(authors.join(' ')) };
  });

  function jaccard(a,b){ var A=new Set(a),B=new Set(b),i=0; A.forEach(x=&gt;{if(B.has(x)) i++;}); var u=A.size+B.size-i; return u? i/u : 0; }
  function extendYearRight(r){ var end=r.endContainer; if(end&amp;&amp;end.nodeType===3){ var tail=end.nodeValue.slice(r.endOffset, r.endOffset+8), m=tail.match(/^\s*(1[4-9]\d{2}|20\d{2}|19\d{2})/); return m?m[1]:'';} return ''; }

  function rankCandidates(query){
    var q=norm(query), m=q.match(/(?:^|\D)((?:1[4-9]\d{2}|20\d{2}|19\d{2}))/), year=m?m[1]:'', qPure=year?q.replace(m[0],' '):q, qt=tok(qPure);
    var isAuthorish = qt.length&lt;=2, wT=isAuthorish?0.2:0.6, wA=isAuthorish?0.7:0.3, wY=1-(wT+wA);
    var scores=[]; refIndex.forEach(function(r){
      var ts=jaccard(qt, r.titleToks), as=jaccard(qt, r.authorToks), ys=(year&amp;&amp;r.year)?(year===r.year?1:(year.replace(/\D/g,'')===r.year.replace(/\D/g,'')?.6:0)):0;
      scores.push([r.n, wT*ts + wA*as + wY*ys, r]);
    });
    scores.sort((a,b)=&gt;b[1]-a[1]); return scores.slice(0,10);
  }

  // UI balonu
  var bubble=(function(){ var d=document.createElement('div'); d.id='tb-qc';
    d.innerHTML='&lt;div class="body"&gt;&lt;/div&gt;&lt;footer&gt;&lt;button type="button" id="tb-qc-cancel"&gt;Kapat&lt;/button&gt;&lt;button type="button" id="tb-qc-apply"&gt;Ekle&lt;/button&gt;&lt;/footer&gt;';
    document.body.appendChild(d); d.querySelector('#tb-qc-cancel').onclick=()=&gt;d.style.display='none'; return d; })();

  function makeSup(n){ var a=document.createElement('a'); a.href='#kaynak'+n; a.textContent=String(n); var sup=document.createElement('sup'); sup.className='tb-cite-added'; sup.appendChild(a); return sup; }
  function insertOnce(range, n){ try{ var sup=makeSup(n), r=range.cloneRange(); r.collapse(false); r.insertNode(sup); sup.scrollIntoView({block:'nearest'});}catch(e){} }
  function insertForAll(needle, n){
    var nd=norm(needle).toLowerCase();
    var walker=document.createTreeWalker(body, NodeFilter.SHOW_TEXT, {acceptNode:function(node){
      if(!node.nodeValue) return NodeFilter.FILTER_REJECT;
      if(node.parentElement.closest('#refs')) return NodeFilter.FILTER_REJECT;
      return node.nodeValue.toLowerCase().includes(nd) ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;
    }});
    var nodes=[]; while(walker.nextNode()) nodes.push(walker.currentNode);
    nodes.forEach(function(node){
      var txt=node.nodeValue, idx=txt.toLowerCase().indexOf(nd); if(idx&lt;0) return;
      var before=document.createTextNode(txt.slice(0, idx+nd.length)), after=document.createTextNode(txt.slice(idx+nd.length));
      var sup=makeSup(n), frag=document.createDocumentFragment(); frag.appendChild(before); frag.appendChild(sup); frag.appendChild(after);
      node.parentNode.replaceChild(frag, node);
    });
  }

  function showBubble(rect, query, ranked, range){
    var bodyEl=bubble.querySelector('.body'); bodyEl.innerHTML='';
    bodyEl.insertAdjacentHTML('beforeend','&lt;div&gt;&lt;strong&gt;â€œ'+query+'â€&lt;/strong&gt; iÃ§in eÅŸleÅŸme seÃ§:&lt;/div&gt;');
    if (!ranked.length){
      bodyEl.insertAdjacentHTML('beforeend','&lt;div&gt;Aday bulunamadÄ±. KaynakÃ§ayÄ± kontrol et.&lt;/div&gt;');
      bubble.querySelector('#tb-qc-apply').onclick=()=&gt;{ bubble.style.display='none'; };
    } else {
      ranked.forEach(function([n,score,r],i){
        bodyEl.insertAdjacentHTML('beforeend',
          '&lt;div class="row"&gt;&lt;label&gt;&lt;input type="radio" name="tb-qc-choice" value="'+n+'" '+(i===0?'checked':'')+'&gt;'+
          '&lt;span&gt;&lt;strong&gt;'+(r.title||'(baÅŸlÄ±k yok)')+'&lt;/strong&gt;&lt;br&gt;&lt;span style="opacity:.75"&gt;'+(r.authors.join(', ')||'')+' â€” '+(r.year||'yÄ±l yok')+' â€¢ skor '+score.toFixed(2)+'&lt;/span&gt;&lt;/span&gt;&lt;/label&gt;&lt;/div&gt;');
      });
      bodyEl.insertAdjacentHTML('beforeend','&lt;div class="row"&gt;&lt;label&gt;&lt;input type="checkbox" id="tb-qc-all"&gt; Bu ifadeye tÃ¼m metinde ekle&lt;/label&gt;&lt;/div&gt;');
      bubble.querySelector('#tb-qc-apply').onclick=function(){
        var chosen=bubble.querySelector('input[name="tb-qc-choice"]:checked'); if(!chosen){ bubble.style.display='none'; return; }
        var n=parseInt(chosen.value,10), applyAll=document.getElementById('tb-qc-all').checked;
        if (applyAll) insertForAll(query, n); else insertOnce(range, n);
        bubble.style.display='none';
      };
    }
    var x=Math.min(window.innerWidth-10, Math.max(10, rect.left + window.scrollX)), y=rect.bottom + window.scrollY + 8;
    bubble.style.left=x+'px'; bubble.style.top=y+'px'; bubble.style.display='block';
  }

  body.addEventListener('dblclick', function(){
    var sel=window.getSelection(); if(!sel||sel.rangeCount===0) return;
    var r=sel.getRangeAt(0).cloneRange(); var s=norm(sel.toString()); if(!s||s.length&gt;120) return;
    var yr=extendYearRight(r); if(yr) s=s+' '+yr;
    var ranked=rankCandidates(s); var rect=r.getBoundingClientRect(); showBubble(rect, s, ranked, r);
  });

  // Undo
  (function(){
    var stack=[], mo=new MutationObserver(function(muts){
      muts.forEach(function(m){ m.addedNodes &amp;&amp; m.addedNodes.forEach(function(n){ if(n.nodeType===1 &amp;&amp; n.classList &amp;&amp; n.classList.contains('tb-cite-added')) stack.push(n); }); });
    });
    mo.observe(document.body,{childList:true,subtree:true});
    document.addEventListener('keydown', function(e){
      if((e.ctrlKey||e.metaKey)&amp;&amp;!e.shiftKey&amp;&amp;e.key.toLowerCase()==='z'){ var el=stack.pop(); if(el&amp;&amp;el.parentNode) el.parentNode.removeChild(el); }
    });
  })();

  // Memory (apply-all kalÄ±cÄ±)
  (function(){
    var STORE='tb_qc_map::'+(location.pathname||location.href);
    function nrm(s){ return (s||'').toString().trim().toLowerCase().replace(/\s+/g,' '); }
    function load(){ try{return JSON.parse(localStorage.getItem(STORE)||'{}');}catch(_){return {}} }
    function save(m){ try{localStorage.setItem(STORE, JSON.stringify(m));}catch(_){ } }
    function insertAll(needle, n){
      var bodyEl=document.querySelector('.post-body')||document;
      needle=nrm(needle);
      var walker=document.createTreeWalker(bodyEl, NodeFilter.SHOW_TEXT, {acceptNode:function(node){
        if(!node.nodeValue) return NodeFilter.FILTER_REJECT;
        if(node.parentElement.closest('#refs')) return NodeFilter.FILTER_REJECT;
        return node.nodeValue.toLowerCase().includes(needle) ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;
      }});
      var nodes=[]; while(walker.nextNode()) nodes.push(walker.currentNode);
      nodes.forEach(function(node){
        var txt=node.nodeValue, low=txt.toLowerCase(), idx=low.indexOf(needle); if(idx&lt;0) return;
        if (idx+needle.length===txt.length){ var ns=node.nextSibling; if(ns &amp;&amp; ns.nodeType===1 &amp;&amp; ns.tagName==='SUP' &amp;&amp; ns.querySelector('a[href="#kaynak'+n+'"]')) return; }
        var before=document.createTextNode(txt.slice(0, idx+needle.length)), after=document.createTextNode(txt.slice(idx+needle.length));
        var a=document.createElement('a'); a.href='#kaynak'+n; a.textContent=String(n); var sup=document.createElement('sup'); sup.appendChild(a);
        var frag=document.createDocumentFragment(); frag.appendChild(before); frag.appendChild(sup); frag.appendChild(after);
        node.parentNode.replaceChild(frag, node);
      });
    }
    var map=load(); Object.keys(map).forEach(function(k){ insertAll(k, map[k]); });
    document.addEventListener('click', function(e){
      if(!e.target.closest('#tb-qc-apply')) return;
      var bubble=document.getElementById('tb-qc'); if(!bubble) return;
      var strong=bubble.querySelector('.body strong'); var raw=strong?strong.textContent.replace(/[â€œâ€]/g,''):'';
      var chosen=bubble.querySelector('input[name="tb-qc-choice"]:checked'); var n=chosen?parseInt(chosen.value,10):null;
      var applyAllEl=bubble.querySelector('#tb-qc-all'); var applyAll=applyAllEl?applyAllEl.checked:false;
      if(!raw||!n) return;
      if(applyAll){ var m=load(); m[nrm(raw)]=n; save(m); }
    }, false);
  })();

  // Export butonu
  (function(){
    var btn=document.createElement('button');
    btn.id='tb-export'; btn.textContent='HTMLâ€™e Kaydet';
    btn.style.cssText='position:fixed;right:16px;bottom:16px;z-index:10001;padding:.55rem .75rem;border:0;border-radius:10px;background:#111;color:#fff;box-shadow:0 10px 30px rgba(0,0,0,.25);cursor:pointer';
    document.body.appendChild(btn);
    btn.addEventListener('click', function(){
      var root=document.createElement('div');
      var clone=(document.querySelector('.post-body')||document.body).cloneNode(true);
      clone.querySelectorAll('#tb-qc, .tb-ref-highlight').forEach(el=&gt;el.remove());
      clone.querySelectorAll('sup.tb-cite-added').forEach(el=&gt;el.classList.remove('tb-cite-added'));
      var refs=clone.querySelector('#refs')||Array.from(clone.querySelectorAll('ol,ul')).slice(-1)[0];
      if(!refs){ alert('KaynakÃ§a listesi bulunamadÄ±.'); return; }
      root.appendChild(clone);
      var html=root.innerHTML.replace(/\sdata-[^=\s]+="[^"]*"/g,'').replace(/\sclass=""/g,'');
      navigator.clipboard.writeText(html).catch(()=&gt;{});
      var blob=new Blob([html], {type:'text/html;charset=utf-8'}), a=document.createElement('a');
      a.href=URL.createObjectURL(blob); a.download='post-body-updated.html'; document.body.appendChild(a); a.click(); a.remove();
      alert('Panoya kopyalandÄ± ve .html indirildi.');
    });
  })();

  // SmoothScroll
  (function(){
    var bodyEl=document.querySelector('.post-body') || document;
    var refs=bodyEl.querySelector('#refs')||(function(){ var ls=Array.from(bodyEl.querySelectorAll('ol,ul')); return ls.length?ls[ls.length-1]:null; })();
    if(!refs) return;
    Array.from(refs.querySelectorAll('li')).forEach(function(li,i){
      var id='kaynak'+(i+1); if(!document.getElementById(id)){ var s=document.createElement('span'); s.id=id; li.insertBefore(s, li.firstChild); }
    });
    function topFixedOffset(){
      var els=Array.from(document.body.querySelectorAll('*')).slice(0,500);
      for(var el of els){ var cs=getComputedStyle(el); if(cs.position==='fixed' &amp;&amp; parseInt(cs.top||'0',10)===0 &amp;&amp; el.offsetHeight&gt;40) return el.offsetHeight+8; }
      var v=getComputedStyle(document.documentElement).getPropertyValue('--tb-header-offset').trim(); return v?parseInt(v,10):0;
    }
    function smoothFocus(target){
      var y=target.getBoundingClientRect().top + window.scrollY - topFixedOffset();
      window.scrollTo({ top:y, behavior:'smooth' });
      var li=target.closest('li'); if(li){ li.classList.add('tb-ref-highlight'); setTimeout(()=&gt;li.classList.remove('tb-ref-highlight'),1600); }
    }
    document.addEventListener('click', function(e){
      var a=e.target.closest('a[href^="#kaynak"]'); if(!a) return;
      var id=a.getAttribute('href').slice(1), tgt=document.getElementById(id); if(!tgt) return;
      e.preventDefault(); smoothFocus(tgt); try{ history.replaceState(null,'','#'+id); }catch(_){}
    }, {passive:false});
  })();
})();
//]]&gt;
&lt;/script&gt;</code></pre>
      </details>
      <figure class="figure"><img class="doc-img" src="assets/doc-image-2.png" alt=""></figure>
      <div class="spacer"></div>
      <h2>3. Ä°ÅŸ AkÄ±ÅŸÄ±: Veriden Ã‡Ä±ktÄ±ya AdÄ±m AdÄ±m Analiz</h2>
      <p>Sistemin Ã§alÄ±ÅŸma prensibi, bir veritabanÄ± sorgu motorunun Ã§alÄ±ÅŸma mantÄ±ÄŸÄ±na benzer. AÅŸaÄŸÄ±daki ÅŸema sistemin temel dÃ¶ngÃ¼sÃ¼nÃ¼ Ã¶zetlemektedir:</p>
      <pre class="code-block"><code class="language-mermaid">graph TD
    A[Sayfa YÃ¼klenmesi] --&gt;|?qc=1| B[HTML Parsing &amp; Ä°ndeksleme]
    B --&gt; C{KullanÄ±cÄ± Eylemi}
    C --&gt;|Ã‡ift TÄ±klama| D[Metin SeÃ§imi &amp; Normalizasyon]
    D --&gt; E[Fuzzy Search &amp; Puanlama]
    E --&gt; F[ArayÃ¼z: Bubble UI GÃ¶sterimi]
    F --&gt; G{Yazar SeÃ§imi}
    G --&gt;|Tek Ekle| H[Range API ile SUP Ekleme]
    G --&gt;|TÃ¼mÃ¼ne Ekle| I[TreeWalker ile Toplu Ä°ÅŸlem]
    H --&gt; J[DOM GÃ¼ncellemesi]
    I --&gt; J
    J --&gt; L[UX KatmanÄ±: Polishing]
    L --&gt; K[Export: Temiz HTML Ã‡Ä±ktÄ±sÄ±]
</code></pre>
      <h3>A. Veri HazÄ±rlÄ±ÄŸÄ± ve Ä°ndeksleme (Indexing)</h3>
      <p>Sayfa yÃ¼klendiÄŸinde script ilk olarak <strong>HTML Parsing</strong> iÅŸlemini baÅŸlatÄ±r.</p>
      <ol>
      <li><strong>Hedef Tespiti:</strong> #refs ID'sine sahip veya metin sonundaki ol/ul listelerini (KaynakÃ§a) bulur.</li>
      <li><strong>GeliÅŸmiÅŸ Yazar AyrÄ±ÅŸtÄ±rma (Particle Detection):</strong> Sadece isimleri deÄŸil, soyisimlerdeki "soyluluk" eklerini de tanÄ±r. authorsOf fonksiyonu; "bin", "van", "de", "von", "mc" gibi parÃ§acÄ±klarÄ± algÄ±layarak "De Wart" gibi isimleri tek bir bÃ¼tÃ¼n (entity) olarak iÅŸler.</li>
      <li><strong>Metadata Ã‡Ä±karÄ±mÄ±:</strong> Regex (DÃ¼zenli Ä°fadeler) kullanÄ±larak listedeki her maddeden Yazar, YÄ±l ve BaÅŸlÄ±k bilgisi ayrÄ±ÅŸtÄ±rÄ±larak refIndex belleÄŸine atÄ±lÄ±r.</li>
      </ol>
      <h3>B. KullanÄ±cÄ± EtkileÅŸimi ve Sorgu (Querying)</h3>
      <p>Yazar, metin Ã¼zerinde bir ifadeye <strong>Ã§ift tÄ±kladÄ±ÄŸÄ±nda</strong> (dblclick event listener) sÃ¼reÃ§ tetiklenir:</p>
      <ol>
      <li><strong>SeÃ§imi AlgÄ±lama:</strong> SeÃ§ilen metin alÄ±nÄ±r. EÄŸer kullanÄ±cÄ± bir cÃ¼mlenin sonunu seÃ§tiyse ve orada bir yÄ±l varsa (extendYearRight), algoritma akÄ±llÄ±ca davranÄ±p yÄ±lÄ± da sorguya dahil eder.</li>
      <li><strong>Fuzzy Matching (BulanÄ±k MantÄ±k):</strong> BurasÄ± sistemin beynidir (rankCandidates). SeÃ§ilen metin, kaynakÃ§adaki verilerle <strong>Jaccard Benzerlik Ä°ndeksi</strong> kullanÄ±larak kÄ±yaslanÄ±r.</li>
      <ul>
      <li><em>AÄŸÄ±rlÄ±klÄ± Skorlama:</em> Algoritma kÃ¶rlemesine eÅŸleÅŸtirme yapmaz. EÄŸer sorgu kÄ±saysa (yazar adÄ± gibi), yazar eÅŸleÅŸmesine <strong>0.7</strong>, baÅŸlÄ±ÄŸa <strong>0.2</strong> puan verir.</li>
      </ul>
      </ol>
      <h3>C. ArayÃ¼z ve ManipÃ¼lasyon (The Bubble UI)</h3>
      <p>KullanÄ±cÄ±nÄ±n seÃ§tiÄŸi metnin hemen Ã¼zerinde dinamik bir <strong>"Action Bubble"</strong> belirir. Yazar doÄŸru kaynaÄŸÄ± seÃ§ip "Ekle" dediÄŸinde, Range API kullanÄ±larak seÃ§ilen metin bozulmadan yanÄ±na &lt;sup&gt;&lt;a href="#kaynak1"&gt;1&lt;/a&gt;&lt;/sup&gt; etiketi "cerrahi" bir hassasiyetle enjekte edilir.</p>
      <h3>D. Otomasyon ve Bellek (Memory &amp; Batch Processing)</h3>
      <p>Kodun en gÃ¼Ã§lÃ¼ yanlarÄ±ndan biri <strong>Toplu Ä°ÅŸlem</strong> yeteneÄŸidir.</p>
      <ul>
      <li><strong>"TÃ¼m metinde ekle":</strong> Yazar bu kutucuÄŸu iÅŸaretlerse, TreeWalker API tÃ¼m makaleyi tarar. AynÄ± yazar isminin veya kitap adÄ±nÄ±n geÃ§tiÄŸi <em>her yeri</em> bulur ve otomatik olarak atÄ±f ekler.</li>
      <li><strong>GÃ¼venlik DuvarÄ± (Duplicate Guard):</strong> Sistem, otomatik ekleme yaparken kelimenin hemen yanÄ±nda zaten bir atÄ±f olup olmadÄ±ÄŸÄ±nÄ± kontrol eder (node.nextSibling). Bu, Gurdjieff[1][1] gibi tekrarlÄ± ve hatalÄ± atÄ±flarÄ±n oluÅŸmasÄ±nÄ± engeller.</li>
      <li><strong>LocalStorage KalÄ±cÄ±lÄ±ÄŸÄ±:</strong> Memory modÃ¼lÃ¼, kullanÄ±cÄ±nÄ±n yaptÄ±ÄŸÄ± "toplu ekleme" tercihlerini tarayÄ±cÄ± hafÄ±zasÄ±na (localStorage) kaydeder.</li>
      </ul>
      <h3>E. Temizleme ve DÄ±ÅŸa AktarÄ±m (Export)</h3>
      <p>Ä°ÅŸ bittiÄŸinde, "HTML'e Kaydet" butonu devreye girer. Sistem, eklediÄŸi CSS'leri, JS listener'larÄ±nÄ± ve arayÃ¼z elemanlarÄ±nÄ± temizler (DOM Cleaning). Sadece saf, temiz HTML kodunu panoya kopyalar ve .html dosyasÄ± olarak indirir.</p>
      <h2>4. KullanÄ±cÄ± Deneyimi: AdÄ±m AdÄ±m Senaryo (Walkthrough)</h2>
      <p>Teknik altyapÄ±nÄ±n pratik hayatta nasÄ±l karÅŸÄ±lÄ±k bulduÄŸunu gÃ¶stermek iÃ§in, bir editÃ¶rÃ¼n "Gurdjieff ve 4. Yol" baÅŸlÄ±klÄ± bir makaleyi dÃ¼zenlediÄŸi senaryoyu izleyelim:</p>
      <ol>
      <li><strong>Aktivasyon:</strong> Yazar, Blogger taslak Ã¶nizleme sayfasÄ±nÄ±n adres Ã§ubuÄŸuna &amp;qc=1 ekler ve Enter'a basar. Bu "Gizli Anahtar", Quick-Cite modÃ¼lÃ¼nÃ¼ uyandÄ±rÄ±r.</li>
      <li><strong>EtkileÅŸim:</strong> Metni okurken "Ä°nsanÄ±n OlasÄ± Evrimi Psikolojisi" ibaresini gÃ¶rÃ¼r ve Ã¼zerine Ã§ift tÄ±klar.</li>
      <li><strong>AnlÄ±k Analiz:</strong> Sistem milisaniyeler iÃ§inde sayfanÄ±n altÄ±ndaki kaynakÃ§ayÄ± tarar. "Psikoloji", "Evrim" ve "OlasÄ±" kelimelerini iÃ§eren kitaplarÄ± puanlar.</li>
      <li><strong>Karar AnÄ± (The Bubble):</strong> Ä°mlecin tepesinde siyah bir balon belirir:</li>
      <ul>
      <li><em>SeÃ§enek A:</em> P.D. Ouspensky - Ä°nsanÄ±n OlasÄ± Evrimi Psikolojisi (%95 EÅŸleÅŸme)</li>
      <li><em>SeÃ§enek B:</em> Darwin - TÃ¼rlerin KÃ¶keni (%10 EÅŸleÅŸme)</li>
      </ul>
      <li><strong>Otomasyon:</strong> Yazar, SeÃ§enek A'yÄ± iÅŸaretler. EÄŸer bu kitap metinde Ã§okÃ§a geÃ§iyorsa, <strong>"Bu ifadeye tÃ¼m metinde ekle"</strong> kutucuÄŸunu da seÃ§er ve "Ekle" butonuna basar.</li>
      <li><strong>SonuÃ§:</strong> Sayfadaki tÃ¼m ilgili ifadelerin yanÄ±na nazikÃ§e bir [4] (veya ilgili sÄ±ra numarasÄ±) eklenir. UX katmanÄ± sayesinde bu numara kelimeye yapÄ±ÅŸmaz, zarif bir boÅŸlukla ayrÄ±lÄ±r.</li>
      <li><strong>Ã‡Ä±ktÄ±:</strong> DÃ¼zenleme bitince saÄŸ alttaki "HTML'e Kaydet" butonuyla temiz kod indirilir ve Blogger paneline yapÄ±ÅŸtÄ±rÄ±lÄ±r.</li>
      </ol>
      <h2>5. KullanÄ±lan Teknolojiler ve Tercih Nedenleri</h2>
      <div class="table-wrap"><table class="doc-table"><thead><tr><th>Teknoloji</th><th>KullanÄ±m AlanÄ±</th><th>Neden Tercih Edildi?</th></tr></thead><tbody><tr><td>Vanilla JS (ES6+)</td><td>TÃ¼m mantÄ±k</td><td>Framework yÃ¼kÃ¼ (React/Vue) olmadan anlÄ±k aÃ§Ä±lÄ±ÅŸ hÄ±zÄ± ve DOM Ã¼zerinde tam kontrol.</td></tr><tr><td>TreeWalker API</td><td>DOM Tarama</td><td>innerHTML ile metin deÄŸiÅŸtirmek HTML yapÄ±sÄ±nÄ± bozar (event listenerlarÄ± siler). TreeWalker sadece &quot;metin dÃ¼ÄŸÃ¼mlerini&quot; gÃ¼venle deÄŸiÅŸtirir.</td></tr><tr><td>Jaccard Similarity</td><td>Arama AlgoritmasÄ±</td><td>Levenshtein gibi pahalÄ± algoritmalar yerine, kÃ¼me kesiÅŸimini baz alan Jaccard, tarayÄ±cÄ±da Ã§ok daha hÄ±zlÄ± Ã§alÄ±ÅŸÄ±r ve kelime sÄ±rasÄ±ndan baÄŸÄ±msÄ±zdÄ±r.</td></tr><tr><td>Range API</td><td>Metin Ä°ÅŸleme</td><td>KullanÄ±cÄ±nÄ±n seÃ§tiÄŸi metnin tam koordinatlarÄ±nÄ± bulmak ve HTML yapÄ±sÄ±nÄ± bozmadan araya element sÄ±kÄ±ÅŸtÄ±rmak iÃ§in.</td></tr><tr><td>MutationObserver</td><td>Dinamik Ä°zleme</td><td>Sonradan eklenen (injected) iÃ§erikleri yakalayÄ±p stil ve davranÄ±ÅŸ kurallarÄ±nÄ± anÄ±nda uygulamak iÃ§in.</td></tr></tbody></table></div>
      <h2>6. UX KatmanÄ±: Atomik DÃ¼zenleyici ve Tipografi (The Polisher)</h2>
      <figure class="figure"><img class="doc-img" src="assets/doc-image-3.jpg" alt=""></figure>
      <div class="spacer"></div>
      <p>Sistemin mÃ¼kemmelleÅŸmesini saÄŸlayan son katman, "Refinement Gadget" olarak adlandÄ±rÄ±lan tamamlayÄ±cÄ± scripttir. Quick-Cite atÄ±flarÄ± eklerken, bu katman editÃ¶r deneyimini optimize eder:</p>
      <ol>
      <li><strong>Tipografik Ä°yileÅŸtirme (Hair Space):</strong> AtÄ±f numaralarÄ±nÄ±n kelimeye yapÄ±ÅŸmasÄ±nÄ± engellemek iÃ§in kod, otomatik olarak gÃ¶rÃ¼nmez bir "ince boÅŸluk" (\u200A) enjekte eder.</li>
      <ul>
      <li><em>Ã–ncesi:</em> ...farkÄ±ndalÄ±k[1] (SÄ±kÄ±ÅŸÄ±k)</li>
      <li><em>SonrasÄ±:</em> ...farkÄ±ndalÄ±kâ€Š[1] (Nefes alan yapÄ±)</li>
      </ul>
      <li><strong>Atomik Veri Koruma:</strong> AtÄ±flar contenteditable="false" Ã¶zelliÄŸi ile kilitlenir. Bu sayede yazar yanlÄ±ÅŸlÄ±kla numaranÄ±n iÃ§ine ([1abc]) yazÄ± yazamaz.</li>
      <li><strong>AkÄ±llÄ± Silme (Backspace Logic):</strong> Ä°mleÃ§ atÄ±fÄ±n yanÄ±ndayken silme tuÅŸuna basÄ±ldÄ±ÄŸÄ±nda, kod devreye girer ve atÄ±fÄ± harf harf deÄŸil, tek bir "obje" gibi blok halinde siler. Bu, HTML yapÄ±sÄ±nÄ±n bozulmasÄ±nÄ± engeller.</li>
      </ol>
      <details>
      <summary><strong>ğŸ¨ Ä°ncele: UX & Tipografi CilasÄ± Kodu</strong></summary>
      <pre class="code-block"><code class="language-html">&lt;style&gt;
/* Superscriptâ€™ler kelimeye yapÄ±ÅŸmasÄ±n */
.tb-cite { margin-left: .15em; }
&lt;/style&gt;

&lt;script type="text/javascript"&gt;
//&lt;![CDATA[
(function(){
  // 1) TÃ¼m .tb-cite'larÄ± normalize et: atomik + Ã¶ncesine ince boÅŸluk (hair space)
  function normalizeCites(root){
    (root || document).querySelectorAll('.tb-cite').forEach(function(sup){
      // Atomik yap: yanlÄ±ÅŸlÄ±kla iÃ§ine yazÄ± eklenmesin
      sup.setAttribute('contenteditable','false');

      // Ã–ncesi boÅŸlukla ayrÄ±lmÄ±ÅŸ mÄ±? DeÄŸilse ince boÅŸluk ekle
      var prev = sup.previousSibling;
      var needsSpace = true;
      if(prev &amp;&amp; prev.nodeType === 3){
        needsSpace = !(/\s$/.test(prev.nodeValue));
      }
      if(needsSpace){
        sup.parentNode.insertBefore(document.createTextNode('\u200A'), sup); // hair space
      }
    });
  }

  // 2) Backspace/Delete davranÄ±ÅŸÄ±: imleÃ§ cite sÄ±nÄ±rÄ±ndaysa sadece cite silinsin
  function keyFix(e){
    var sel = window.getSelection();
    if(!sel || !sel.isCollapsed) return; // sadece tek nokta imleÃ§te
    var node = sel.anchorNode, offset = sel.anchorOffset;

    // Text node iÃ§inde misin?
    if(!node || node.nodeType !== 3) return;

    var parent = node.parentNode;
    var before = null, after = null;

    // Offset konumuna gÃ¶re komÅŸu dÃ¼ÄŸÃ¼mleri bul
    if(e.key === 'Backspace'){
      // imleÃ§ satÄ±rÄ±n baÅŸÄ±nda ise Ã¶nceki kardeÅŸe bak
      if(offset === 0){
        before = parent.previousSibling;
      }else{
        // metnin iÃ§inde: imleÃ§ten Ã¶nce ayrÄ± bir sup yoksa bÄ±rak
        return;
      }
    } else if(e.key === 'Delete'){
      // imleÃ§ sonda ise sonraki kardeÅŸe bak
      if(offset === node.nodeValue.length){
        after = parent.nextSibling;
      }else{
        return;
      }
    } else {
      return;
    }

    var targetSup = null;
    if(before &amp;&amp; before.nodeType === 1 &amp;&amp; before.matches('.tb-cite')) targetSup = before;
    if(after  &amp;&amp; after.nodeType  === 1 &amp;&amp; after.matches('.tb-cite'))  targetSup = after;

    if(targetSup){
      e.preventDefault();
      // Ã–nÃ¼ndeki olasÄ± hair spaceâ€™i de temizle
      var ps = targetSup.previousSibling;
      if(ps &amp;&amp; ps.nodeType===3 &amp;&amp; /\u200A$/.test(ps.nodeValue)){
        ps.nodeValue = ps.nodeValue.replace(/\u200A$/,'');
      }
      targetSup.remove();
    }
  }

  // Ä°lk yÃ¼klemede ve sonradan eklenenlerde uygula
  function run(){ normalizeCites(document); }
  if(document.readyState==='loading'){ document.addEventListener('DOMContentLoaded', run); } else { run(); }
  document.addEventListener('keydown', keyFix, true);

  // Dinamik iÃ§erik yÃ¼klenirse de normalize et
  new MutationObserver(function(muts){
    var touched=false;
    muts.forEach(function(m){ if(m.addedNodes &amp;&amp; m.addedNodes.length) touched=true; });
    if(touched) normalizeCites(document);
  }).observe(document.documentElement, {childList:true, subtree:true});
})();
 //]]&gt;
&lt;/script&gt;</code></pre>
      </details>
      <h2>7. Somut Faydalar: Neden Ã–nemli?</h2>
      <ol>
      <li><strong>Hata PayÄ±nÄ±n SÄ±fÄ±rlanmasÄ±:</strong> Manuel yazÄ±mda "kaynak 4"e atÄ±f yaparken yanlÄ±ÅŸlÄ±kla "kaynak 5" yazma riski vardÄ±r. Quick-Cite, ID bazlÄ± Ã§alÄ±ÅŸtÄ±ÄŸÄ± (#kaynakN) iÃ§in linkler her zaman doÄŸru hedefe gider.</li>
      <li><strong>%80 Zaman Tasarrufu:</strong> 3000 kelimelik, 50 atÄ±flÄ± bir makalede her atÄ±fÄ± tek tek elle kodlamak saatler sÃ¼rer. "TÃ¼mÃ¼ne Ekle" Ã¶zelliÄŸi ile bu sÃ¼re dakikalara iner.</li>
      <li><strong>AkÄ±ÅŸÄ±n KorunmasÄ±:</strong> Yazar, HTML kodlarÄ± arasÄ±nda boÄŸulmaz. GÃ¶rsel arayÃ¼zde (WYSIWYG) kalÄ±r, sadece Ã§ift tÄ±klar ve seÃ§er. DÃ¼ÅŸÃ¼nce akÄ±ÅŸÄ± bÃ¶lÃ¼nmez.</li>
      <li><strong>Otomatik Linkleme (Smooth Scroll):</strong> Kod, aynÄ± zamanda okuyucu deneyimi iÃ§in scroll-margin-top ve CSS highlight efektlerini de otomatik ekler. Okuyucu bir atÄ±fa tÄ±kladÄ±ÄŸÄ±nda, sayfa yumuÅŸakÃ§a aÅŸaÄŸÄ± kayar ve ilgili kaynak sarÄ± renkle parlar.</li>
      </ol>
      <h2>8. SonuÃ§</h2>
      <p>Tabirly iÃ§in yazÄ±lan bu kod parÃ§asÄ±, teknik bir scriptten ziyade, <strong>iÃ§erik Ã¼retim sÃ¼recine entegre edilmiÅŸ bir mikro-uygulamadÄ±r.</strong></p>
      <p>Åu anki haliyle Quick-Cite; karmaÅŸÄ±k, akademik formatlÄ± iÃ§erikleri Blogger gibi basit bir altyapÄ±da bile profesyonelce yÃ¶netmeyi mÃ¼mkÃ¼n kÄ±lan, <strong>Ã¶lÃ§eklenebilir ve sÃ¼rdÃ¼rÃ¼lebilir</strong> bir mÃ¼hendislik Ã§Ã¶zÃ¼mÃ¼dÃ¼r.</p>
      <div class="spacer"></div>
      <p>https://tr.tabirly.com/</p>
    </article>
  </main>
</body>
</html>
